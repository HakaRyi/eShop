@page "/EditMember/{MemberId:int}"
@using BOs.Entities
@using ServiceLayer.Interfaces
@inject IMemberService MemberService
@inject NavigationManager Navigation

<h2>Edit Member</h2>

@if (member == null)
{
    <p><em>Loading...</em></p>
}
else
{
    <EditForm Model="member" OnValidSubmit="HandleValidSubmit" FormName="EditMemberForm">
        <DataAnnotationsValidator />
        <ValidationSummary />

        <div>
            <label>Email:</label>
            <InputText @bind-Value="member.Email" class="form-control" />
        </div>

        <div>
            <label>Company Name:</label>
            <InputText @bind-Value="member.CompanyName" class="form-control" />
        </div>

        <div>
            <label>City:</label>
            <InputText @bind-Value="member.City" class="form-control" />
        </div>

        <div>
            <label>Country:</label>
            <InputSelect @bind-Value="member.Country" class="form-control">
                <option value="">-- Select Country --</option>
                <option>USA</option>
                <option>Vietnam</option>
                <option>Japan</option>
                <option>Germany</option>
            </InputSelect>
        </div>

        <button type="submit" class="btn btn-primary">Save</button>
        <button type="button" class="btn btn-secondary" @onclick="GoBack">Cancel</button>
    </EditForm>
}

@code {
    [Parameter]
    public int MemberId { get; set; }

    private Member member;

    protected override void OnParametersSet()
    {
        member = MemberService.GetMemberById(MemberId);
    }

    private void HandleValidSubmit()
    {
        try
        {
            MemberService.UpdateMember(member);
            Navigation.NavigateTo("/");
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Có lỗi xảy ra: {ex.Message}");
        }
    }

    private void GoBack()
    {
        Navigation.NavigateTo("/");
    }
}

